---
title: "Self-hosting n8n から Hono + BullMQ に移行した"
categories:
    - blog
tags:
    - apps
toc: true
---

以前 [n8n の self-hosting のすすめ](/blog/2024/09/16/n8n.html) という記事を書きましたが、最近は n8n をやめて Hono + BullMQ の構成に移行しました。  
その経緯と所感をまとめます。

## 移行先の構成

[Hono](https://hono.dev/) と [BullMQ](https://bullmq.io/) を組み合わせ、TypeScript で実装しています。
BullMQ の Job Scheduler で cron スケジュール実行、Hono で Webhook の受け付けを行っています。

[前回の記事](/blog/2024/09/16/n8n.html)と同様に Synology NAS 上で動かしており、app コンテナと Redis コンテナを Docker Compose で立ち上げています。

現在動いているワークフローは、

- 毎日12時にRSSフィードから新着記事の情報を取得し、AI要約とリンクを通知
- 毎日7時に天気予報を取得・加工し、AIによる外干しプラを付加して通知
- 睡眠トラッキングアプリ（Sleep as Android）のイベントを Webhook で受け取り、寝室の照明（SwitchBot）の自動制御や通知

などがあります。
いずれも、n8n ワークフローからの移行です。

## なぜ移行したか

AIコーディングツールの進化で「コードを書く」コストが劇的に下がったためです。

元記事では以下のように書いていました。

> コード生成（プロンプトを組み立て、コードを生成させ、動作を検証し、実行環境を整えてデプロイする）する方法よりも早く目的の処理を実現できました。

2024年9月時点ではこれが実感でした。  
しかし2026年2月現在、Claude Code に簡潔な依頼を投げるだけで、公式ライブラリを探してドキュメントを読み、実装、テスト、デプロイ、資料更新までを一貫してやってくれるようになりました。  
「コードを書く」側のコストが大きく下がったことで、n8n を使う動機が薄れました。

## 組み込みノードの難しさ

n8n は500を超える組み込みの integrations を持っており、そのおかげでローコードで様々なワークフローを実現できます。  

ただ、実際に使ったのはそのうちのごくわずかでした。
また、Claude API をはじめ未対応のサービスも多く、対応していてもメジャーではない機能や新しく追加されたばかりの機能には対応が追いついていません。
特にAI関連サービスは変化が速いため、組み込みノードの恩恵を受けにくい領域でした。

そうなると、各社の API を調べ、Edit ノードや Code ノードを組み合わせて HTTP Request ノードで API を直接叩き、レスポンスを再び基本的なノードで加工し…、という流れになりがちで、フローの構築に時間と手間がかかります。  
それよりは、サービス公式のライブラリを入れてコードで書いた方がずっと早い、と感じるようになりました。

## GUI ワークフローと AI の相性

GUI ベースのワークフロー構築やデバッグは、AI に任せにくいと感じました。  
n8n-mcp のような試みもありますが、普通の TypeScript を書かせて、普通にテストして、というサイクルの方が楽でスムーズでした。

n8n の Code ノード内にコードを書くこともできますが、実ファイルのコードならテストも書けますし、差分管理もしやすいです。

## 「妻でも編集できる」のその後

n8n 導入時は、コーディングが不慣れな妻でも GUI でワークフローを編集できることがメリットの1つでした。

しかし今や、妻も Claude Code を使って開発するようになりました。  
AI も、人も、成長しました。

## チューニング

Redis コンテナをデフォルト設定のまま起動したところ、ほぼ待機状態のシステムにしてはそれなりの CPU 使用率がありました。  
Redis の `hz` パラメータ（バックグラウンドタスクの実行頻度）を `1` に設定したところ、app コンテナと同程度の低い水準に落ち着きました。

以下の画像は、左半分が before で、停止、再起動（スパイク部分）を経て、after でCPU使用率の低下を確認するまでの様子です。  
![Redis の hz 設定変更前後の CPU 使用率](/assets/2026/2026-02-23-n8n-to-hono-bullmq/redis-cpu.png)

メモリ使用量は n8n の約350MBに対し、新構成では50MB以下になりました。

## さいごに

n8n は視覚的なわかりやすさや実行履歴の管理など、優れた点が多いツールです。  
しかし今では、個人的な「動けば十分」なワークフローの作成・メンテナンス程度なら、AIに全て任せられるようになりGUIのワークフローエディタは不要になりました。

元記事の最後では

> n8nを超えるとしたら、もっとAIが活用されるようになるのかなと思います。
> フローの構築や編集も、人力ではなくAIに任せられるようになると嬉しいですね。

と書いていましたが、その通りになりました。

2027年末あたりには、全て AI Agent に置き換わっているかもしれません。
